<html>
  <script src="//www.WEBRTC-Experiment.com/RecordRTC.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="js/audio.js"></script>
  <script src="js/cloudApi.js"></script>
  <script src="js/main.js"></script>
<body>

  <div style="display:none">
    <!-- hide for now -->
    <button onclick="audioRecorder.startRecording()">Start Recording</button>
    <button onclick="audioRecorder.stopRecording()">Stop Recording</button>
    <button onclick="transmitRecording()">Transmit Recording</button>
    <button onclick="saveRecording()">Save Recording</button>
  </div>
  <button id='toggleButton' disabled onclick="toggleTranscribe()">Start the demo</button>
  <a style="display:none" id="save" href="">Save</a>
  <pre id="console" style="background-color:#ACACAC; width:500px; height:100px"></pre>

  <script>
    /**
     *  Various Globals and initialization.
     */
    var audioRecorder;
    function initGapi(){
      console.log('loading gapi');

      var xhr = new XMLHttpRequest();
      xhr.overrideMimeType("application/json");
      xhr.open('GET', '/config.json', true);
      xhr.onreadystatechange = function () {
        if (xhr.readyState == 4 && xhr.status == "200") {
          var json = JSON.parse(xhr.responseText);
          gapi.client.setApiKey(json.apiKey);
        }
      };
      xhr.send(null);

      gapi.client.load('speech', 'v1beta1', function() {
        gapi.client.load('language', 'v1beta1', function() {
          document.getElementById('toggleButton').disabled = false;
        });
      });
    }
    initAudio();
  </script>
  <script src="https://apis.google.com/js/client:api.js?onload=initGapi"></script>
</body>
</html>
